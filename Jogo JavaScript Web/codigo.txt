#include "mbed.h"

#define BLINKING_RATE 100ms
#define BT_PRESSIONADO 0
#define BT_SOLTO 1

enum Estado {
    On1,
    OFF1,
    On2,
    OFF2,
};

Estado estadoAtual = On1;
DigitalOut led(LED1);
DigitalIn bt(BUTTON1);

void blinkLED(int duration_ms) {
    for(int i=duration_ms; i > 0 ; i -= 100){
        led = !led;
        ThisThread::sleep_for(100ms);
    }
    led = 0;
}

int main() {
    while (true) {
        switch (estadoAtual) {
            case On1:
                led = 1;
                blinkLED(2000);
                estadoAtual = OFF1;
                break;
            case OFF1:
                led = 0;
                ThisThread::sleep_for(5s);
                estadoAtual = On1;
                break;
            case On2:
                blinkLED(5000);
                estadoAtual = OFF2;
                break;
            case OFF2:
                led = 0;
                if (bt == 1) { 
                    ThisThread::sleep_for(100ms); 
                    if (bt == 1) { 
                        estadoAtual = On1;
                    }
                }
                break;
        }
    }
}
